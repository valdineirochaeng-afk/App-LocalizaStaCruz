<script>
    const DATA_URL = './dadosLocais.json'; 
    let dados = [];

    async function carregar() {
        try {
            const res = await fetch(DATA_URL);
            if (!res.ok) throw new Error('Arquivo não encontrado');
            
            dados = await res.json();

            const selOri = document.getElementById('origem');
            const selDes = document.getElementById('destino');
            selOri.innerHTML = ""; selDes.innerHTML = "";

            dados.forEach((item, i) => {
                let opt = document.createElement('option');
                opt.value = i;
                
                // AJUSTADO: Agora ele busca especificamente pela chave "Nome"
                opt.innerText = item.Nome || `Local ${i+1}`;
                
                selOri.appendChild(opt.cloneNode(true));
                selDes.appendChild(opt);
            });

            document.getElementById('status').innerText = "✅ Dados carregados!";
            document.getElementById('status').style.background = "#d4edda";
        } catch (e) {
            console.error(e);
            document.getElementById('status').innerText = "❌ Erro ao ler nomes do JSON";
            document.getElementById('status').style.background = "#f8d7da";
        }
    }

    function gerarRota() {
        const c1 = dados[document.getElementById('origem').value];
        const c2 = dados[document.getElementById('destino').value];
        
        if (!c1 || !c2) return alert("Selecione os locais");

        // Link oficial corrigido
        const url = `https://www.google.com{c1.LATITUDE},${c1.LONGITUDE}&destination=${c2.LATITUDE},${c2.LONGITUDE}&travelmode=driving`;
        window.open(url, '_blank');
    }

    carregar();
</script>
